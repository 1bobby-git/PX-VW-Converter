<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>VW 계산기 · VW 변환기 | PX↔VW 변환 도구</title>
  <style>
    :root { color-scheme: light; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif; background:#f6f7fb; color:#111; }

    /* 전체 폭 확장 */
    .wrap { max-width: none; width: 100%; margin: 0; padding: 24px 24px 48px; }

    h1 { margin: 6px 0 10px; font-size: 28px; }
    p.lead { margin: 0 0 18px; color:#333; line-height:1.6; }

    .grid { display: grid; gap: 14px; grid-template-columns: 1fr; }
    @media (min-width: 860px){ .grid { grid-template-columns: 1fr 1fr; } }

    /* CSS 변환 영역은 더 넓게 */
    .cssGrid { display:grid; gap:14px; grid-template-columns: 1fr; }
    @media (min-width: 980px){ .cssGrid { grid-template-columns: 1fr 1fr; } }

    .card { background:#fff; border: 1px solid #e6e8ef; border-radius: 14px; box-shadow: 0 6px 22px rgba(12, 19, 40, 0.06); padding: 16px; }
    .card h2 { margin: 0 0 10px; font-size: 18px; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; align-items: end; }

    label { display:block; font-size: 12px; color:#444; margin: 0 0 6px; }
    input[type="number"], textarea, select {
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #d7dbe7;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 14px;
      outline: none;
      background:#fff;
    }

    /* textarea 높이 확장 */
    textarea {
      min-height: 320px;
      resize: vertical;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      line-height:1.5;
    }

    input[type="number"]:focus, textarea:focus, select:focus { border-color:#6b7cff; box-shadow: 0 0 0 3px rgba(107,124,255,0.18); }
    .col { flex: 1 1 220px; }

    .btns { display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
    button {
      border: 1px solid #d7dbe7;
      background: #111;
      color: #fff;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 14px;
      cursor: pointer;
    }
    button.secondary { background:#fff; color:#111; }
    button:active { transform: translateY(1px); }

    .hint { margin-top:8px; font-size: 12px; color:#666; line-height:1.5; }

    .kv { display:flex; gap: 12px; flex-wrap: wrap; }
    .kv .item { flex: 1 1 220px; }

    .out {
      font-weight: 700;
      font-size: 18px;
      padding: 10px 12px;
      border-radius: 10px;
      background:#f2f4ff;
      border: 1px solid #dbe0ff;
      word-break: break-all;
    }

    .check {
      display:flex; gap:8px; align-items:center; margin: 6px 0 10px;
      font-size: 13px; color:#222;
    }
    .check input { width: 16px; height: 16px; }

    footer { margin-top: 18px; color:#777; font-size: 12px; text-align:center; }
    code.k { background:#f0f2f7; padding: 2px 6px; border-radius: 6px; }

    /* 큰 화면에서 CSS 변환 카드 내부도 시원하게 */
    @media (min-width: 1200px){
      textarea { min-height: 420px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>VW 계산기 · VW 변환기 (PX ↔ VW)</h1>
    <p class="lead">PX(픽셀)과 VW(뷰포트 너비) 단위를 빠르게 변환하고, CSS 소스의 PX 값을 VW로 일괄 변환할 수 있습니다.</p>

    <div class="card" style="margin-bottom:14px;">
      <div class="row">
        <div class="col">
          <label for="viewportWidth">뷰포트 너비 (px)</label>
          <input id="viewportWidth" type="number" min="1" step="1" value="375">
          <div class="hint">계산 기준이 되는 화면 너비입니다. 예: <code class="k">360</code> / <code class="k">375</code> / <code class="k">414</code> / <code class="k">768</code> / <code class="k">1024</code></div>
        </div>
        <div class="col">
          <label for="precision">소수점 자릿수</label>
          <select id="precision">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2" selected>2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
          <div class="hint">출력되는 VW, PX 결과의 소수점 자릿수입니다.</div>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h2>PX → VW 변환</h2>
        <div class="kv">
          <div class="item">
            <label for="pxInput">PX</label>
            <input id="pxInput" type="number" step="0.01" placeholder="예: 16">
          </div>
          <div class="item">
            <label>VW</label>
            <div class="out" id="vwOutput">-</div>
          </div>
        </div>
        <div class="btns">
          <button id="btnPxToVw">변환</button>
          <button class="secondary" id="btnCopyVw">VW 복사</button>
          <button class="secondary" id="btnClear1">초기화</button>
        </div>
        <div class="hint">공식: <code class="k">VW = (PX ÷ 뷰포트너비) × 100</code></div>
      </div>

      <div class="card">
        <h2>VW → PX 변환</h2>
        <div class="kv">
          <div class="item">
            <label for="vwInput">VW</label>
            <input id="vwInput" type="number" step="0.01" placeholder="예: 4.27">
          </div>
          <div class="item">
            <label>PX</label>
            <div class="out" id="pxOutput">-</div>
          </div>
        </div>
        <div class="btns">
          <button id="btnVwToPx">변환</button>
          <button class="secondary" id="btnCopyPx">PX 복사</button>
          <button class="secondary" id="btnClear2">초기화</button>
        </div>
        <div class="hint">공식: <code class="k">PX = (VW ÷ 100) × 뷰포트너비</code></div>
      </div>
    </div>

    <div class="card" style="margin-top:14px;">
      <h2>CSS 소스 변환</h2>

      <div class="check">
        <input id="onlyPxProps" type="checkbox" checked>
        <label for="onlyPxProps" style="margin:0;">불필요한 속성 제거 (px가 포함된 선언만 유지) + 비어있는 블록 삭제</label>
      </div>

      <div class="cssGrid">
        <div class="card" style="box-shadow:none; border-style:dashed;">
          <h2 style="font-size:16px;">CSS 소스 입력</h2>
          <textarea id="cssInput" placeholder="예) margin-top:16px;text-align:center;
예) .box{margin-top:16px;text-align:center;padding:0 20px;}
예) .a{text-align:center;}  (→ 비어있어져서 삭제됨)
예) 여러 줄도 OK"></textarea>
          <div class="btns">
            <button id="btnConvertCss">PX → VW 변환</button>
            <button class="secondary" id="btnClearCss">초기화</button>
          </div>
          <div class="hint">
            체크 ON이면 <code class="k">px</code>가 들어있는 속성만 남기고 나머지는 삭제합니다.<br>
            속성 제거 후 <code class="k">{}</code> 처럼 비어버린 규칙은 통째로 삭제합니다.<br>
            예) <code class="k">margin-top:16px;text-align:center;</code> → <code class="k">margin-top:16px;</code>
          </div>
        </div>

        <div class="card" style="box-shadow:none; border-style:dashed;">
          <h2 style="font-size:16px;">변환된 CSS</h2>
          <textarea id="cssOutput" readonly placeholder="여기에 결과가 출력됩니다."></textarea>
          <div class="btns">
            <button class="secondary" id="btnCopyCss">결과 복사</button>
          </div>
          <div class="hint">
            변환 규칙: CSS 텍스트 안의 <code class="k">숫자px</code>를 찾아 <code class="k">vw</code>로 변환합니다.
          </div>
        </div>
      </div>
    </div>

    <footer>© PX↔VW Converter</footer>
  </div>

  <script>
    function $(id) { return document.getElementById(id); }

    function toNumber(v) {
      var n = parseFloat(v);
      if (isNaN(n)) return null;
      return n;
    }

    function getViewportWidth() {
      var vw = toNumber($("viewportWidth").value);
      if (!vw || vw <= 0) return null;
      return vw;
    }

    function getPrecision() {
      var p = parseInt($("precision").value, 10);
      if (isNaN(p) || p < 0) return 2;
      return p;
    }

    function roundTo(n, p) {
      var m = Math.pow(10, p);
      return Math.round(n * m) / m;
    }

    function formatNum(n, p) {
      var r = roundTo(n, p);
      if (p === 0) return String(Math.round(r));
      return r.toFixed(p);
    }

    function copyText(text) {
      if (!text || text === "-") return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text);
        return;
      }
      var ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      try { document.execCommand("copy"); } catch (e) {}
      document.body.removeChild(ta);
    }

    /* px 포함 선언만 유지 */
    function keepOnlyPxDeclarations(styleText) {
      if (!styleText) return "";

      var list = styleText.split(";");
      var kept = [];
      var i, decl, idx, prop, value;

      for (i = 0; i < list.length; i++) {
        decl = (list[i] || "").trim();
        if (!decl) continue;

        idx = decl.indexOf(":");
        if (idx === -1) continue;

        prop = decl.slice(0, idx).trim();
        value = decl.slice(idx + 1).trim();

        /* 값에 px가 포함된 선언만 유지
           예: 16px, -2.5px, 0px, 0 20px, calc(100% - 16px) */
        if (/\b-?\d*\.?\d+px\b/i.test(value)) {
          kept.push(prop + ":" + value);
        }
      }

      return kept.length ? (kept.join(";") + ";") : "";
    }

    /* {}가 비어있는 규칙 삭제 */
    function removeEmptyCssBlocks(cssText) {
      if (!cssText) return "";

      /* selector{} / @media{} 등 내용이 비어있는 블록 제거
         단순 규칙 기반이지만 일반적인 변환기 입력 범위에서는 충분히 안정적 */
      var out = cssText.replace(/[^{}]+\{\s*\}/g, "");

      /* 잔여 공백/빈 줄 정리 */
      out = out.replace(/[ \t]+\n/g, "\n");
      out = out.replace(/\n{3,}/g, "\n\n");

      return out.trim();
    }

    /* selector { ... } 블록 내부 정리 + 빈 블록 제거 */
    function keepOnlyPxInCssBlocks(cssText) {
      if (!cssText) return "";

      var out = cssText.replace(/\{[^}]*\}/g, function (block) {
        var inner = block.slice(1, -1);
        var cleaned = keepOnlyPxDeclarations(inner);
        return "{" + cleaned + "}";
      });

      out = removeEmptyCssBlocks(out);
      return out;
    }

    /* px -> vw 변환 */
    function convertPxToVwInText(text, viewportWidth, precision) {
      if (!text) return "";

      return text.replace(/(-?\d*\.?\d+)px\b/g, function (all, num) {
        var px = parseFloat(num);
        if (isNaN(px)) return all;

        var vw = (px / viewportWidth) * 100;
        var s = formatNum(vw, precision);

        if (s.indexOf("-0") === 0) s = s.replace("-0", "0");
        return s + "vw";
      });
    }

    function onPxToVw() {
      var vw = getViewportWidth();
      if (!vw) { $("vwOutput").textContent = "-"; return; }

      var p = getPrecision();
      var px = toNumber($("pxInput").value);
      if (px === null) { $("vwOutput").textContent = "-"; return; }

      var out = formatNum((px / vw) * 100, p) + "vw";
      if (out.indexOf("-0") === 0) out = out.replace("-0", "0");
      $("vwOutput").textContent = out;
    }

    function onVwToPx() {
      var vw = getViewportWidth();
      if (!vw) { $("pxOutput").textContent = "-"; return; }

      var p = getPrecision();
      var val = toNumber($("vwInput").value);
      if (val === null) { $("pxOutput").textContent = "-"; return; }

      var out = formatNum((val / 100) * vw, p) + "px";
      if (out.indexOf("-0") === 0) out = out.replace("-0", "0");
      $("pxOutput").textContent = out;
    }

    function onConvertCss() {
      var vw = getViewportWidth();
      if (!vw) { $("cssOutput").value = ""; return; }

      var p = getPrecision();
      var src = $("cssInput").value || "";
      var onlyPx = $("onlyPxProps").checked;

      var cleaned = src;

      if (onlyPx) {
        if (cleaned.indexOf("{") !== -1 && cleaned.indexOf("}") !== -1) {
          cleaned = keepOnlyPxInCssBlocks(cleaned);
        } else {
          cleaned = keepOnlyPxDeclarations(cleaned);
          /* 선언 리스트 모드에서는 {} 개념이 없으니 별도 삭제 없음 */
        }
      }

      var out = convertPxToVwInText(cleaned, vw, p);
      $("cssOutput").value = out;
    }

    function bind() {
      $("btnPxToVw").addEventListener("click", onPxToVw);
      $("btnVwToPx").addEventListener("click", onVwToPx);
      $("btnConvertCss").addEventListener("click", onConvertCss);

      $("btnCopyVw").addEventListener("click", function () { copyText($("vwOutput").textContent); });
      $("btnCopyPx").addEventListener("click", function () { copyText($("pxOutput").textContent); });
      $("btnCopyCss").addEventListener("click", function () { copyText($("cssOutput").value); });

      $("btnClear1").addEventListener("click", function () { $("pxInput").value = ""; $("vwOutput").textContent = "-"; });
      $("btnClear2").addEventListener("click", function () { $("vwInput").value = ""; $("pxOutput").textContent = "-"; });
      $("btnClearCss").addEventListener("click", function () { $("cssInput").value = ""; $("cssOutput").value = ""; });

      $("pxInput").addEventListener("input", onPxToVw);
      $("vwInput").addEventListener("input", onVwToPx);
    }

    bind();
  </script>
</body>
</html>
